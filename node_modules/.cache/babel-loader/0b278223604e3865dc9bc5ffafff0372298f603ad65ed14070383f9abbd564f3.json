{"ast":null,"code":"\"use strict\";\n\n// Copyright 2017 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EventId = void 0;\nconst uuid = require(\"uuid\");\n// This function is pulled directly from the d64 module:\n// https://github.com/dominictarr/d64\n// That module hasn't been updated in 8 years, and misuses the Buffer package.\n// See issue here: https://github.com/google/eventid-js/issues/160\nconst chars = '.PYFGCRLAOEUIDHTNSQJKXBMWVZ_pyfgcrlaoeuidhtnsqjkxbmwvz1234567890'.split('').sort().join('');\nfunction encode(data) {\n  let s = '';\n  const l = data.length;\n  let hang = 0;\n  for (let i = 0; i < l; i++) {\n    const v = data[i];\n    switch (i % 3) {\n      case 0:\n        s += chars[v >> 2];\n        hang = (v & 3) << 4;\n        break;\n      case 1:\n        s += chars[hang | v >> 4];\n        hang = (v & 0xf) << 2;\n        break;\n      case 2:\n        s += chars[hang | v >> 6];\n        s += chars[v & 0x3f];\n        hang = 0;\n        break;\n    }\n  }\n  if (l % 3) s += chars[hang];\n  return s;\n}\nclass EventId {\n  constructor() {\n    this.b = new Uint8Array(24);\n    uuid.v4(null, this.b, 8);\n  }\n  new() {\n    for (let i = 7; i >= 0; i--) {\n      if (this.b[i] !== 255) {\n        this.b[i]++;\n        break;\n      }\n      this.b[i] = 0;\n    }\n    return encode(this.b);\n  }\n}\nexports.EventId = EventId;\n// preserve `const EventId = require('EventId')` syntax\nconst existingExports = module.exports;\nmodule.exports = EventId;\nmodule.exports = Object.assign(module.exports, existingExports);","map":{"version":3,"names":["uuid","require","chars","split","sort","join","encode","data","s","l","length","hang","i","v","EventId","constructor","b","Uint8Array","v4","new","exports","existingExports","module","Object","assign"],"sources":["../../src/index.ts"],"sourcesContent":[null],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAEA,MAAAA,IAAA,GAAAC,OAAA;AAEA;AACA;AACA;AACA;AACA,MAAMC,KAAK,GAAG,kEAAkE,CAC7EC,KAAK,CAAC,EAAE,CAAC,CACTC,IAAI,EAAE,CACNC,IAAI,CAAC,EAAE,CAAC;AAEX,SAASC,MAAMA,CAACC,IAAgB;EAC9B,IAAIC,CAAC,GAAG,EAAE;EACV,MAAMC,CAAC,GAAGF,IAAI,CAACG,MAAM;EACrB,IAAIC,IAAI,GAAG,CAAC;EACZ,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,CAAC,EAAEG,CAAC,EAAE,EAAE;IAC1B,MAAMC,CAAC,GAAGN,IAAI,CAACK,CAAC,CAAC;IACjB,QAAQA,CAAC,GAAG,CAAC;MACX,KAAK,CAAC;QACJJ,CAAC,IAAIN,KAAK,CAACW,CAAC,IAAI,CAAC,CAAC;QAClBF,IAAI,GAAG,CAACE,CAAC,GAAG,CAAC,KAAK,CAAC;QACnB;MACF,KAAK,CAAC;QACJL,CAAC,IAAIN,KAAK,CAACS,IAAI,GAAIE,CAAC,IAAI,CAAE,CAAC;QAC3BF,IAAI,GAAG,CAACE,CAAC,GAAG,GAAG,KAAK,CAAC;QACrB;MACF,KAAK,CAAC;QACJL,CAAC,IAAIN,KAAK,CAACS,IAAI,GAAIE,CAAC,IAAI,CAAE,CAAC;QAC3BL,CAAC,IAAIN,KAAK,CAACW,CAAC,GAAG,IAAI,CAAC;QACpBF,IAAI,GAAG,CAAC;QACR;;;EAGN,IAAIF,CAAC,GAAG,CAAC,EAAED,CAAC,IAAIN,KAAK,CAACS,IAAI,CAAC;EAC3B,OAAOH,CAAC;AACV;AAEA,MAAaM,OAAO;EAElBC,YAAA;IACE,IAAI,CAACC,CAAC,GAAG,IAAIC,UAAU,CAAC,EAAE,CAAC;IAC3BjB,IAAI,CAACkB,EAAE,CAAC,IAAI,EAAE,IAAI,CAACF,CAAC,EAAE,CAAC,CAAC;EAC1B;EAEAG,GAAGA,CAAA;IACD,KAAK,IAAIP,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;MAC3B,IAAI,IAAI,CAACI,CAAC,CAACJ,CAAC,CAAC,KAAK,GAAG,EAAE;QACrB,IAAI,CAACI,CAAC,CAACJ,CAAC,CAAC,EAAE;QACX;;MAEF,IAAI,CAACI,CAAC,CAACJ,CAAC,CAAC,GAAG,CAAC;;IAEf,OAAON,MAAM,CAAC,IAAI,CAACU,CAAC,CAAC;EACvB;;AAhBFI,OAAA,CAAAN,OAAA,GAAAA,OAAA;AAmBA;AACA,MAAMO,eAAe,GAAGC,MAAM,CAACF,OAAO;AACtCE,MAAM,CAACF,OAAO,GAAGN,OAAO;AACxBQ,MAAM,CAACF,OAAO,GAAGG,MAAM,CAACC,MAAM,CAACF,MAAM,CAACF,OAAO,EAAEC,eAAe,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}